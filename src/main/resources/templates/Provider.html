<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>EV Data Analytics Marketplace - Provider</title>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Montserrat:wght@400;500;600;700;800&display=swap" rel="stylesheet">

<!--CSS-->
<link rel="stylesheet" href="../static/css/index.css">
<link rel="stylesheet" href="../static/css/style.css">
<link rel="stylesheet" href="../static/css/providerStyle.css">

</head>
<body>

  <!-- Header -->
  <header class="header-area header-sticky">
      <a href="index.html">
        <img class="logo" src="../static/images/LogoEV.png" alt="logo">
      </a>
      <div class="search-container">
        <i class="fas fa-search"></i>
        <input type="text" placeholder="Search EV data, models, analytics...">
        <img class="search-icon" src="../static/images/search.png" alt="search">
      </div>
      <nav class="main-nav">
          <ul class="nav">
              <li class="scroll-to-section"><a href="index.html">Home</a></li>
              <li><a href="Admin.html">ADMIN</a></li>
              <li><a href="Consumer.html">Consumer</a></li>
              <li><a href="Provider.html" class="active">Provider</a></li>
              <li class="scroll-to-section"><a href="#testimonials">Testimonials</a></li>
              <li><a href="contact-us.html">Contact Support</a></li>
          </ul>
      </nav>
  </header>

  <!-- Banner -->
  <section class="page-heading">
      <div class="container">
          <div class="row">
              <div class="col-lg-12">
                  <div class="header-text">
                      <h2>Data Provider</h2>
                      <div class="div-dec"></div>
                  </div>
              </div>
          </div>
      </div>
  </section>

    <!-- Provider Navigation Tabs -->
  <div class="main-tabs">
    <div class="container">
      <div class="tabs-container">
        <button class="tab-btn active" data-tab="dashboard">Provider Dashboard</button>
        <button class="tab-btn" data-tab="data-management">Data Management</button>
        <button class="tab-btn" data-tab="policy-pricing">Policy & Pricing</button>
        <button class="tab-btn" data-tab="revenue-tracking">Revenue Tracking</button>
        <button class="tab-btn" data-tab="security-anonymization">Security & Anonymization</button>
      </div>
    </div>
  </div>

<!-- MAIN CONTENT -->
<main class="main-container">

  <!-- Dashboard Tab -->
  <div id="dashboard" class="tab-content active">
    <!-- Section 1 -->
    <section class="main-section">
      <h2>1. Register & Manage Data Sources</h2>
      <div class="main-card">
        <div class="card-body">
            <h5>Providing EV data</h5>
            <ul>
                <li>Put battery, journey, charging, and electricity transaction data on the marketplace</li>
                <li>Choose to share data as <strong>Raw</strong> or <strong>Analyzed</strong></li>
                <li>Manage dataset lists that have been uploaded, edited, or deleted</li>
            </ul>
            <button class="btn btn-primary" onclick="switchTab('data-management')">Register & Manage Data Sources</button>
        </div>
      </div>
    </section>

    <!-- Section 2 -->
    <section class="main-section">
      <h2>2. Setting up sharing policies & pricing</h2>
      <div class="main-card">
        <div class="card-body">
          <h5>Data Policy & Pricing</h5>
          <ul>
            <li>Data pricing by download, capacity, or subscription</li>
            <li>Usage rights control</li>
            <li>Free option for public data</li>
          </ul>
          <button class="btn btn-success" onclick="switchTab('policy-pricing')">Setting up sharing policies & pricing</button>
        </div>
      </div>
    </section>

    <!-- Section 3 -->
    <section class="main-section">
      <h2>3. Data revenue tracking</h2>
      <div class="main-card">
        <div class="card-body">
          <h5>Reports & Statistics</h5>
          <ul>
            <li>View data downloads and revenue</li>
            <li>Analyze customer behavior</li>
            <li>Download detailed reports</li>
          </ul>
          <button class="btn btn-warning" onclick="switchTab('revenue-tracking')">Data revenue tracking</button>
        </div>
      </div>
    </section>

    <!-- Section 4 -->
    <section class="main-section">
      <h2>4. Data Security & Anonymization</h2>
      <div class="main-card">
        <div class="card-body">
          <h5>Data Protection & Privacy</h5>
          <ul>
            <li>Remove PII before sharing</li>
            <li>GDPR & CCPA compliant</li>
            <li>Permission control</li>
          </ul>
          <button class="btn btn-info" onclick="switchTab('security-anonymization')">Data Security & Anonymization</button>
        </div>
      </div>
    </section>
  </div>

  <!-- Data Management Tab (static form) -->
  <div id="data-management" class="tab-content">
    <main class="form-mini">
      <form onsubmit="handleUpload(event)">
        <label>Data name:</label>
        <input name="dataName" type="text" placeholder="Enter the data name..." required>

        <label>Describe:</label>
        <textarea name="describe" placeholder="Enter a short description..."></textarea>

        <label>Data type:</label>
        <select name="dataType">
          <option>Battery</option>
          <option>Trip</option>
          <option>Charging</option>
          <option>Electricity transactions</option>
        </select>

        <label>Share mode:</label>
        <select name="shareMode">
          <option>Raw (original data)</option>
          <option>Analyzed</option>
        </select>

        <label>Data file:</label>
        <input name="dataFile" type="file" accept=".csv,.json,.xlsx" required>

        <div class="form-btn-group">
          <button type="submit" class="btn btn-primary">ðŸ“¤ Upload</button>
          <button type="button" class="btn-back" onclick="switchTab('dashboard')">â¬… Come back</button>
        </div>
      </form>
    </main>
  </div>

  <!-- Policy & Pricing Tab (static form) -->
  <div id="policy-pricing" class="tab-content">
    <main class="form-mini">
      <form onsubmit="handlePolicySubmit(event)">
        <label>Dataset (mock):</label>
        <select name="dataset">
          <option>Battery Health - 2025</option>
          <option>Charging Sessions - Q1</option>
          <option>Driving Patterns - Sample</option>
        </select>

        <label>Pricing model:</label>
        <select name="pricingModel">
          <option>Per download</option>
          <option>Subscription</option>
          <option>By data size</option>
        </select>

        <label>Price (USD):</label>
        <input name="price" type="number" min="0" step="0.01" value="99">

        <label>License:</label>
        <select name="license">
          <option>Research / Academic</option>
          <option>Commercial</option>
          <option>Internal use only</option>
        </select>

        <label>Visibility:</label>
        <select name="visibility">
          <option>Public</option>
          <option>Restricted</option>
          <option>Private</option>
        </select>

        <label><input type="checkbox" name="freePreview" checked> Allow free preview sample</label>

        <label>Policy description:</label>
        <textarea name="policyDesc" placeholder="Short description of policy and usage terms..."></textarea>

        <div class="form-btn-group">
          <button type="submit" class="btn btn-primary">Save Policy</button>
          <button type="button" class="btn-back" onclick="switchTab('dashboard')">â¬… Come back</button>
        </div>
      </form>
    </main>
  </div>

  <!-- Revenue Tracking Tab -->
  <div id="revenue-tracking" class="tab-content">
    <div class="stat-grid" style="margin-top:12px;">
      <div class="stat-box">
        <div class="num" id="stat-total-revenue">$0</div>
        <div class="label">Total revenue</div>
      </div>
      <div class="stat-box">
        <div class="num" id="stat-downloads">0</div>
        <div class="label">Downloads</div>
      </div>
      <div class="stat-box">
        <div class="num" id="stat-buyers">0</div>
        <div class="label">Unique buyers</div>
      </div>
    </div>

    <div style="margin-top:8px;">
      <label for="revMonth">Filter month:</label>
      <select id="revMonth" onchange="renderMiniChart()">
        <option value="all">Last 12 months</option>
        <option value="6">Last 6 months</option>
        <option value="3">Last 3 months</option>
      </select>
    </div>

    <div style="margin-top:12px;" id="chartArea">
      <div class="mini-chart" id="miniChartContainer"></div>
    </div>

    <div style="margin-top:14px;">
      <h4>Recent downloads</h4>
      <table class="table-small">
        <thead><tr><th>Dataset</th><th>User</th><th>Date</th><th>Revenue</th></tr></thead>
        <tbody>
          <tr><td>Battery Health - 2025</td><td>Acme Labs</td><td>2025-09-12</td><td>$299</td></tr>
          <tr><td>Charging Sessions - Q1</td><td>GridCo</td><td>2025-09-02</td><td>$199</td></tr>
          <tr><td>Driving Patterns - Sample</td><td>DriveAI</td><td>2025-08-21</td><td>$149</td></tr>
        </tbody>
      </table>
    </div>

    <div class="form-mini" style="margin-top:12px;">
      <div class="form-btn-group">
        <button type="button" class="btn btn-primary" onclick="exportCsv()">Export CSV</button>
        <button type="button" class="btn-back" onclick="switchTab('dashboard')">â¬… Come back</button>
      </div>
    </div>
  </div>

  <!-- Security & Anonymization Tab -->
  <div id="security-anonymization" class="tab-content">
    <main class="form-mini">
      <form onsubmit="handleSecuritySubmit(event)">
        <label>Dataset (mock):</label>
        <select name="dataset">
          <option>Battery Health - 2025</option>
          <option>Charging Sessions - Q1</option>
          <option>Driving Patterns - Sample</option>
        </select>

        <label><input id="removePii" type="checkbox" name="removePii"> Remove PII (irreversible)</label>

        <label>Anonymization method:</label>
        <select name="method">
          <option>Mask (replace sensitive fields)</option>
          <option>Hash (deterministic)</option>
          <option>Aggregate (roll-up)</option>
        </select>

        <label>Access control:</label>
        <select name="access">
          <option>Open</option>
          <option>Whitelist</option>
          <option>Approval required</option>
        </select>

        <label><input type="checkbox" name="audit"> Enable audit logging</label>

        <label>Notes / instructions:</label>
        <textarea name="notes" placeholder="Notes for reviewers or processors..."></textarea>

        <div class="form-btn-group">
          <button type="submit" class="btn btn-primary">Apply Settings</button>
          <button type="button" class="btn-back" onclick="switchTab('dashboard')">â¬… Come back</button>
        </div>
      </form>
    </main>
  </div>

</main>

<!-- Footer -->
<footer class="footer">
  <div class="footer-container">
    <div class="footer-grid">
      <div class="footer-about">
        <h3 class="footer-title">EV-DataHub</h3>
        <p class="footer-desc">Empowering the future of mobility through secure, anonymized electric vehicle data analytics and insights.</p>
      </div>
      <div>
        <h4 class="footer-heading">Platform</h4>
        <ul class="footer-links">
          <li><a href="#">Data Catalog</a></li>
          <li><a href="#">API Documentation</a></li>
          <li><a href="#">Pricing</a></li>
          <li><a href="#">Security</a></li>
        </ul>
      </div>
      <div>
        <h4 class="footer-heading">Company</h4>
        <ul class="footer-links">
          <li><a href="#">About Us</a></li>
          <li><a href="#">Careers</a></li>
          <li><a href="#">Privacy Policy</a></li>
          <li><a href="#">Terms of Service</a></li>
        </ul>
      </div>
    </div>

    <div class="footer-bottom">
      <p>Â© 2025 EV-DataHub. All rights reserved.</p>
    </div>
  </div>
</footer>

<!-- Confirm modal used by Security form (kept hidden here) -->
<div id="confirmModal" class="confirm-modal" aria-hidden="true" style="display:none;">
  <div class="dialog" role="dialog" aria-modal="true" aria-labelledby="confirmTitle">
    <h3 id="confirmTitle">Confirm Remove PII</h3>
    <p>Removing personally identifiable information (PII) is irreversible in this operation. Are you sure you want to proceed?</p>
    <div class="actions">
      <button class="btn-back" onclick="closeConfirm(false)">Cancel</button>
      <button class="btn btn-primary" onclick="closeConfirm(true)">Yes, proceed</button>
    </div>
  </div>
</div>

<!-- Scripts -->
<script>
/* ---------- Constants ---------- */
const TITLE_MAP = {
  dashboard: "Data Provider",
  "data-management": "Register & Manage Data Sources",
  "policy-pricing": "Sharing Policies & Pricing",
  "revenue-tracking": "Data Revenue Tracking",
  "security-anonymization": "Data Security & Anonymization"
};

let pendingConfirm = null;

/* ---------- Tab logic ---------- */
function switchTab(tabId) {
  document.querySelector('.page-heading .header-text h2').textContent =
    TITLE_MAP[tabId] || "Provider";

  toggleActive(".tab-btn", btn => btn.dataset.tab === tabId);
  toggleActive(".tab-content", c => c.id === tabId, true);

  if (tabId === "revenue-tracking") renderMiniChart();
}

function toggleActive(selector, isActive, isBlock = false) {
  document.querySelectorAll(selector).forEach(el => {
    const active = isActive(el);
    el.classList.toggle("active", active);
    if (isBlock) el.style.display = active ? "block" : "none";
  });
}

/* ---------- Init ---------- */
document.addEventListener("DOMContentLoaded", () => {
  // Hide inactive tabs
  toggleActive(".tab-content", el => el.classList.contains("active"), true);

  // Tab click handlers
  document.querySelectorAll(".tab-btn")
    .forEach(btn => btn.addEventListener("click", () => switchTab(btn.dataset.tab)));

  // Mock revenue data
  window.revenueData = [120, 200, 180, 220, 260, 300, 280, 320, 350, 300, 340, 360];
  setStat("stat-total-revenue", "$12,450");
  setStat("stat-downloads", "1,234");
  setStat("stat-buyers", "86");
});

function setStat(id, value) {
  const el = document.getElementById(id);
  if (el) el.textContent = value;
}

/* ---------- Forms ---------- */
function handleUpload(e) {
  e.preventDefault();
  alert(`Dataset "${e.target.dataName.value || "<no name>"}" uploaded!`);
  switchTab("dashboard");
}

function handlePolicySubmit(e) {
  e.preventDefault();
  alert("Policy saved!");
  switchTab("dashboard");
}

/* ---------- Revenue chart ---------- */
function renderMiniChart() {
  const sel = document.getElementById("revMonth");
  let data = [...window.revenueData];
  if (sel.value === "6") data = data.slice(-6);
  if (sel.value === "3") data = data.slice(-3);

  const box = document.getElementById("miniChartContainer");
  box.innerHTML = "";

  const max = Math.max(...data, 1);
  data.forEach(v => {
    const col = document.createElement("div");
    col.className = "col";
    col.style.height = Math.round((v / max) * 100) + "%";
    box.appendChild(col);
  });
}

function exportCsv() {
  alert("Export CSV!");
}

/* ---------- Security + Modal ---------- */
function handleSecuritySubmit(e) {
  e.preventDefault();
  const remove = e.target.removePii?.checked;
  if (remove) {
    showConfirm().then(ok => {
      alert(ok ? "Security settings applied (remove PII confirmed)" : "Operation cancelled.");
      if (ok) switchTab("dashboard");
    });
  } else {
    alert("Security settings applied!");
    switchTab("dashboard");
  }
}

function showConfirm() {
  return new Promise(resolve => {
    pendingConfirm = resolve;
    const m = document.getElementById("confirmModal");
    m.style.display = "flex";
    m.setAttribute("aria-hidden", "false");
  });
}

function closeConfirm(result) {
  const m = document.getElementById("confirmModal");
  m.style.display = "none";
  m.setAttribute("aria-hidden", "true");
  pendingConfirm?.(result);
  pendingConfirm = null;
}
</script>

</body>
</html>
